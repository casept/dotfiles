"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.utf8_code2len = exports.characterIndex = void 0;
const UTF8_2BYTES_START = 0x80;
const UTF8_3BYTES_START = 0x800;
const UTF8_4BYTES_START = 65536;
function characterIndex(content, byteIndex) {
    if (byteIndex == 0)
        return 0;
    let characterIndex = 0;
    let total = 0;
    for (let codePoint of content) {
        let code = codePoint.codePointAt(0);
        if (code >= UTF8_4BYTES_START) {
            characterIndex += 2;
            total += 4;
        }
        else {
            characterIndex += 1;
            total += utf8_code2len(code);
        }
        if (total >= byteIndex)
            break;
    }
    return characterIndex;
}
exports.characterIndex = characterIndex;
function utf8_code2len(code) {
    if (code < UTF8_2BYTES_START)
        return 1;
    if (code < UTF8_3BYTES_START)
        return 2;
    if (code < UTF8_4BYTES_START)
        return 3;
    return 4;
}
exports.utf8_code2len = utf8_code2len;
//# sourceMappingURL=util.js.map